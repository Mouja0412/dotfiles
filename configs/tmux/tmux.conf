# https://github.com/seebi/tmux-colors-solarized/blob/master/tmuxcolors-256.conf
# Largely copied from https://github.com/tmux-plugins/tmux-sensible

# utf8 is on
# set -g utf8 on
# set -g status-utf8 on

# address vim mode switching delay (http://superuser.com/a/252717/65504)
set -s escape-time 0

# increase scrollback buffer size
set -g history-limit 50000

# tmux messages are displayed for 4 seconds
set -g display-time 4000

# set only on OS X where it's required
# set -g default-command "reattach-to-user-namespace -l $SHELL"

# upgrade $TERM
set -g default-terminal "screen-256color"

# emacs key bindings in tmux command prompt (prefix + :) are better than
# vi keys, even for vim users
set -g status-keys emacs

# focus events enabled for terminals that support them
set -g focus-events on

# super useful when using "grouped sessions" and multi-monitor setup
setw -g aggressive-resize on

# Activity monitoring
setw -g monitor-activity on
set -g visual-activity on

## Prefix / Signalling ---------------------------------------------------------

# C-b is not acceptable -- Vim uses it
set -gu prefix2
unbind `
unbind C-b
set -g prefix `
bind ` send-prefix

# set window split
bind-key v split-window -h
bind-key s split-window

# hjkl pane traversal
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# reload config
bind r source-file "${XDG_CONFIG_HOME}/tmux/tmux.conf" \; display-message "Config reloaded..."

## Status Bar ------------------------------------------------------------------
set -g status-interval 1
set -g status-style bg=colour235,fg=colour136,default # bg=base02, fg=yellow

# default window title colors
setw -g window-status-style fg=colour244,bg=default,dim # fg=base0

# active window title colors
setw -g window-status-current-style fg=colour166,bg=default,bright # fg=orange

# pane border
set -g pane-border-style fg=colour235 #fg=base02
set -g pane-active-border-style fg=colour240 #fg=base01

# message text
# set -g message-style bg=colour235,fg=colour166 # bg=base02, fg=orange

# pane number display
set -g display-panes-active-colour colour33 #blue
set -g display-panes-colour colour166 #orange

# clock
setw -g clock-mode-colour green #green

set -g status-justify centre # center align window list

set -g status-left-length 30
left=""
left="${left} #[fg=green,bright]#H"
# left="${left} #[fg=blue]#(echo $(uptime) | cut -f 3 -d " " | cut -f 1 -d ,)"
set -g status-left "${left}#[default]"

set -g status-right-length 140
right=""
right="${right} #[fg=white,bold]%a %b %d, %H:%M:%S"
#"#[fg=green,bg=default,bright]#(tmux-mem-cpu-load)
# #[fg=red,dim,bg=default]#(uptime | cut -f 4-5 -d " " | cut -f 1 -d ",")
# #[fg=white,bg=default]%a%l:%M:%S %p#[default] #[fg=blue]%Y-%m-%d"
set -g status-right "${right}#[default]"

# Start numbering at 1
set -g base-index 1

# Allows for faster key repetition
set -s escape-time 0

# Allows us to use C-a a <command> to send commands to a TMUX session inside
# another TMUX session
# bind-key a send-prefix

# set to main-horizontal, 66% height for main pane
# bind m run-shell "~/.tmux/scripts/resize-adaptable.sh -l main-horizontal -p 66"
# Same thing for verical layouts
# bind M run-shell "~/.tmux/scripts/resize-adaptable.sh -l main-vertical -p 50"

# bind-key C command-prompt -p "Name of new window: " "new-window -n "%%""

# auto window rename
# setw -g automatic-rename

# https://github.com/edkolev/dots/blob/master/tmux.conf
# Updates for tmux 1.9"s current pane splitting paths.

# # Vi copypaste mode
# setw -g mode-keys vi
# if-shell "test "\( #{$TMUX_VERSION_MAJOR} -eq 2 -a #{$TMUX_VERSION_MINOR} -ge 4 \)"" "bind-key -Tcopy-mode-vi v send -X begin-selection; bind-key -Tcopy-mode-vi y send -X copy-selection-and-cancel"
# if-shell "\( #{$TMUX_VERSION_MAJOR} -eq 2 -a #{$TMUX_VERSION_MINOR} -lt 4\) -o #{$TMUX_VERSION_MAJOR} -le 1" "bind-key -t vi-copy v begin-selection; bind-key -t vi-copy y copy-selection"

# status bar
# if-shell "\( #{$TMUX_VERSION_MAJOR} -eq 2 -a #{$TMUX_VERSION_MINOR} -lt 2\) -o #{$TMUX_VERSION_MAJOR} -le 1" "set -g status-utf8 on"

# rm mouse mode fail
# if-shell "\( #{$TMUX_VERSION_MAJOR} -eq 2 -a #{$TMUX_VERSION_MINOR} -ge 1\)" "set -g mouse off"
# if-shell "\( #{$TMUX_VERSION_MAJOR} -eq 2 -a #{$TMUX_VERSION_MINOR} -lt 1\) -o #{$TMUX_VERSION_MAJOR} -le 1" "set -g mode-mouse off"
#
# fix pane_current_path on new window and splits
# if-shell "test "#{$TMUX_VERSION_MAJOR} -gt 1 -o \( #{$TMUX_VERSION_MAJOR} -eq 1 -a #{$TMUX_VERSION_MINOR} -ge 8 \)"" "unbind c; bind c new-window -c "#{pane_current_path}""
# if-shell "test "#{$TMUX_VERSION_MAJOR} -gt 1 -o \( #{$TMUX_VERSION_MAJOR} -eq 1 -a #{$TMUX_VERSION_MINOR} -ge 8 \)"" "unbind "\""; bind "\"" split-window -v -c "#{pane_current_path}""
# if-shell "test "#{$TMUX_VERSION_MAJOR} -gt 1 -o \( #{$TMUX_VERSION_MAJOR} -eq 1 -a #{$TMUX_VERSION_MINOR} -ge 8 \)"" "unbind v; bind v split-window -h -c "#{pane_current_path}""
# if-shell "test "#{$TMUX_VERSION_MAJOR} -gt 1 -o \( #{$TMUX_VERSION_MAJOR} -eq 1 -a #{$TMUX_VERSION_MINOR} -ge 8 \)"" "unbind %; bind % split-window -h -c "#{pane_current_path}""
#
#
# Colors
# How to use true colors in vim under tmux? #1246 for 2.6 and higher
# https://github.com/tmux/tmux/issues/1246:
# set -g default-terminal "tmux-256color"
# set -ga terminal-overrides ",*256col*:Tc"

# Doesn"t work on iterm2 / mac
# # if-shell "test "\( #{$TMUX_VERSION_MAJOR} -eq 2 -a #{$TMUX_VERSION_MINOR} -ge 6 \)"" "set -g default-terminal "tmux-256color""
# # if-shell "test "\( #{$TMUX_VERSION_MAJOR} -eq 2 -a #{$TMUX_VERSION_MINOR} -ge 6 \)"" "set -ga terminal-overrides ",*256col*:Tc""

# Try screen256-color (https://github.com/tmux/tmux/issues/622):
# if-shell "test "\( #{$TMUX_VERSION_MAJOR} -eq 2 -a #{$TMUX_VERSION_MINOR} -ge 6 \)"" "set -g default-terminal "screen-256color""
# if-shell "test "\( #{$TMUX_VERSION_MAJOR} -eq 2 -a #{$TMUX_VERSION_MINOR} -ge 6 \)"" "set -ga terminal-overrides ",screen-256color:Tc""

# if-shell "\( #{$TMUX_VERSION_MAJOR} -eq 2 -a #{$TMUX_VERSION_MINOR} -lt 6\) -o #{$TMUX_VERSION_MAJOR} -le 1" "set -g default-terminal "screen-256color""

# set -t @tpm_plugins "
#   tmux-plugins/tpm                   \
#   tmux-plugins/tmux-yank             \
#   tmux-plugins/tmux-cpu              \
#   tmux-plugins/tmux-sidebar          \
#   tmux-plugins/tmux-pain-control     \
#   tmux-plugins/tmux-sessionist       \
#   tmux-plugins/tmux-continuum        \
#   tmux-plugins/tmux-resurrect        \
# "

set -g @plugin "tmux-plugins/tpm"
set -g @plugin "tmux-plugins/tmux-yank"
set -g @plugin "tmux-plugins/tmux-cpu"
set -g @plugin "tmux-plugins/tmux-pain-control"
set -g @plugin "tmux-plugins/tmux-sessionist"
set -g @plugin "tmux-plugins/tmux-continuum"
set -g @plugin "tmux-plugins/tmux-resurrect"

set -g @continuum-boot "on"
set -g @continuum-restore "on"
set -g @continuum-boot-options "iterm"
set -g @pane-resize "20"

#right=""
#right="${right} #{cpu_bg_color} #{cpu_icon} #{cpu_percentage}"
#set -g status-right "${right}#[default]"

set-environment -g PATH "/usr/local/bin:/bin:/usr/bin"
run -b "~/.tmux/plugins/tpm/tpm"
